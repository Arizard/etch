{{ define "main" }}
<header class="post-header">
  <h1>{{ .Title }}</h1>
</header>
<article>
  {{- .Content -}}
</article>
<div class="article-after">
  {{- partial "svg/coffee.html" -}}<br>
  {{- with .Page.Params.Date -}}
    <time>{{ .Format "2 January 2006" }}</time>
  {{- end -}}
  {{- if .Page.Params.hero_attribution -}}
  <div class="post-hero-attribution">
    <span>Thumbnail Attribution: {{ .RenderString .Page.Params.hero_attribution }}</span>
  </div>
  {{- end -}}
</div>

{{- if not .Params.nobottomnav -}}
<div class="bottom-nav">
  <div class="tags-container">
    <div class="bottom-nav-label">Tags</div>
    {{ with .Page.GetTerms "tags" }}
    {{- partial "terms-cloud-page.html" . -}}
    {{ end }}
  </div>
  <div class="bottom-nav-next">
    <div class="bottom-nav-label">Read next</div>
    {{ with .PrevInSection }}
    {{- partial "post-item.html" . -}}
    {{ else }}
    {{ with site.GetPage .Section }}
    {{ with index (.RegularPages.ByDate) (sub (len .RegularPages.ByDate) 1) }}
    {{- partial "post-item.html" . -}}
    {{ end }}
    {{ end }}
    {{ end }}
  </div>
</div>
{{ end }}

{{- if not .Params.nocomment -}}
<div id="gomments-container">
</div>
{{- $reactBuilt := resources.Get "js/react.js" | js.Build (dict "minify" true "targetPath" "react.js") -}}
<script src="{{ $reactBuilt.RelPermalink }}" defer></script>
{{$gommentsBuildOpts := dict
"minify" (not hugo.IsDevelopment)
"sourceMap" (cond hugo.IsDevelopment "external" "")
"targetPath" "gomments.js"
}}
{{- $gommentsBuilt := resources.Get "js/react-gomments/index.jsx" | js.Build $gommentsBuildOpts -}}
<script src="{{ $gommentsBuilt.RelPermalink }}" defer></script>
{{- end -}}
{{ end }}
